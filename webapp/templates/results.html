<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ê²°ê³¼ â€” Korean Forced Aligner</title>
    <style>
      body { 
        font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; 
        margin: 2rem; 
        font-size: 18px;
      }
      .card { 
        max-width: 1100px; 
        margin: 0 auto; 
        padding: 3rem; 
        border: 1px solid #ddd; 
        border-radius: 8px; 
      }
      h1 { 
        margin-top: 0; 
        font-size: 2rem;
      }
      .nav { 
        display: flex; 
        justify-content: flex-end; 
        margin-bottom: 1.5rem; 
        padding-bottom: 1rem;
        border-bottom: 2px solid #e0e0e0;
      }
      .home-link { 
        text-decoration: none; 
        color: #0d6efd; 
        font-weight: 600; 
        font-size: 1rem;
      }
      .home-link:hover { text-decoration: underline; }
      table { 
        width: 100%; 
        border-collapse: collapse; 
        margin: 2rem 0;
        font-size: 1rem;
      }
      th, td { 
        border-bottom: 1px solid #eee; 
        padding: 1rem 0.8rem; 
        text-align: left; 
      }
      th {
        background: #f8f9fa;
        font-weight: 600;
        color: #333;
      }
      .ok { color: #0a7f25; font-weight: 600; }
      .fail { color: #b00020; font-weight: 600; }
      .hint { 
        color: #666; 
        font-size: 1rem; 
        margin: 1.5rem 0;
        padding: 0.8rem 1rem;
        background: #f8f9fa;
        border-radius: 6px;
      }
      .btn { 
        display: inline-block; 
        padding: 0.6rem 1.2rem; 
        border-radius: 6px; 
        background: #0d6efd; 
        color: #fff; 
        text-decoration: none; 
        font-size: 1rem;
        font-weight: 500;
      }
      .btn:hover { background: #0b5ed7; }
      .btn.secondary { background: #6c757d; }
      .btn.secondary:hover { background: #5a6268; }
      pre { 
        white-space: pre-wrap; 
        background: #fafafa; 
        padding: 1rem; 
        border: 1px solid #eee; 
        border-radius: 6px; 
        max-height: 250px; 
        overflow: auto; 
        font-size: 0.95rem;
        line-height: 1.5;
      }
    </style>
  </head>
  <body>
    <div class="card">
      <div class="nav">
        <a class="home-link" href="{{ url_for('index') }}" title="í™ˆìœ¼ë¡œ">
          ğŸ  í™ˆìœ¼ë¡œ
        </a>
      </div>
      <h1>âœ… ì •ë ¬ ê²°ê³¼</h1>
      <div class="hint">ğŸ“‹ Job ID: {{ job_id }} â€” ì„±ê³µ <strong>{{ total_ok }}</strong> / {{ results|length }}</div>

      {% if results %}
      <table>
        <thead>
          <tr>
            <th>WAV</th>
            <th>TXT/LAB</th>
            <th>ê²°ê³¼</th>
            <th>ë‹¤ìš´ë¡œë“œ</th>
          </tr>
        </thead>
        <tbody>
          {% for r in results %}
          <tr>
            <td>{{ r.wav }}</td>
            <td>{{ r.txt }}</td>
            <td>
              {% if r.ok %}
              <span class="ok">OK</span>
              {% else %}
              <span class="fail">FAIL</span>
              {% endif %}
            </td>
            <td>
              {% if r.ok %}
              <a class="btn" href="{{ url_for('download', job_id=job_id, filename=r.out) }}">TextGrid</a>
              {% else %}
              â€”
              {% endif %}
            </td>
          </tr>
          {% if r.preview %}
          <tr>
            <td colspan="4">
              <div class="hint">ë¡œë§ˆì ë¯¸ë¦¬ë³´ê¸° (ìƒìœ„ 5ì¤„)</div>
              <pre>{{ r.preview }}</pre>
            </td>
          </tr>
          {% endif %}
          <!-- ë¡œê·¸ ì¶œë ¥ ì£¼ì„ ì²˜ë¦¬
          <tr>
            <td colspan="4"><pre>{{ r.log }}</pre></td>
          </tr>
          -->
          {% endfor %}
        </tbody>
      </table>
      {% endif %}

      {% if skipped %}
      <h3>ë§¤ì¹­ ë¶ˆê°€ (TXT ë¯¸ë°œê²¬)</h3>
      <ul>
        {% for s in skipped %}
        <li>{{ s }}</li>
        {% endfor %}
      </ul>
      {% endif %}

      <p>
        <a class="btn secondary" href="{{ url_for('index') }}">ë‹¤ì‹œ ì—…ë¡œë“œ</a>
        {% if zip_available %}
          <a class="btn" style="margin-left: 0.5rem" href="{{ url_for('download_zip', job_id=job_id) }}">ğŸ“¦ ëª¨ë‘ ZIP ë‹¤ìš´ë¡œë“œ</a>
          <div style="margin-top: 1rem; padding: 0.8rem; background: #fff3cd; border: 1px solid #ffc107; border-radius: 6px; color: #856404; font-size: 0.95rem;">
            âš ï¸ <strong>ì£¼ì˜:</strong> ZIP ë‹¤ìš´ë¡œë“œ í›„ ì„œë²„ì˜ ëª¨ë“  íŒŒì¼ì´ ìë™ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤. ê°œë³„ íŒŒì¼ ë‹¤ìš´ë¡œë“œëŠ” ZIP ë‹¤ìš´ë¡œë“œ ì „ì—ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.
          </div>
        {% endif %}
      </p>
    </div>
  </body>
  </html>
